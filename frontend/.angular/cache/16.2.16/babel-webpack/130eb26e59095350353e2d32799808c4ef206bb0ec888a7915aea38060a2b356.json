{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nlet RoleGuard = /*#__PURE__*/(() => {\n  class RoleGuard {\n    router;\n    constructor(router) {\n      this.router = router;\n    }\n    canActivate(route, state) {\n      // 1. Retrieve the expected roles from the route data\n      const expectedRoles = route.data['roles'];\n      if (!expectedRoles || expectedRoles.length === 0) {\n        console.error('[ROLE_GUARD] Route defined without \"data.roles\". Access denied to prevent security leaks.');\n        return false;\n      }\n      // 2. Retrieve current user from LocalStorage\n      const userInfo = localStorage.getItem('userInfo');\n      if (!userInfo) {\n        console.warn('[ROLE_GUARD] No user info found. Redirecting to login.');\n        this.router.navigate(['/auth/login']);\n        return false;\n      }\n      const user = JSON.parse(userInfo);\n      const userRole = user.role;\n      // 3. Check if the user's role is in the allowed list\n      if (expectedRoles.includes(userRole)) {\n        return true;\n      } else {\n        console.warn(`[ROLE_GUARD] Access Denied. User Role: '${userRole}'. Allowed: ${JSON.stringify(expectedRoles)}`);\n        // Redirect based on actual role to prevent infinite loops\n        if (userRole === 'admin') {\n          this.router.navigate(['/admin']);\n        } else {\n          this.router.navigate(['/user']);\n        }\n        return false;\n      }\n    }\n    static ɵfac = function RoleGuard_Factory(t) {\n      return new (t || RoleGuard)(i0.ɵɵinject(i1.Router));\n    };\n    static ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: RoleGuard,\n      factory: RoleGuard.ɵfac,\n      providedIn: 'root'\n    });\n  }\n  return RoleGuard;\n})();\nexport { RoleGuard };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}