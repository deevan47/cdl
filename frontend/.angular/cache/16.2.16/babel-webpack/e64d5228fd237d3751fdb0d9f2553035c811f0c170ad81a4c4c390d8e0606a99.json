{"ast":null,"code":"import _asyncToGenerator from \"/home/deevan/cdl-project-management-system/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { __decorate, __param } from \"tslib\";\nimport { Injectable, NotFoundException } from '@nestjs/common';\nimport { InjectRepository } from '@nestjs/typeorm';\nimport { Project } from '../entities/project.entity';\nimport { ProjectStage } from '../entities/project-stage.entity';\nimport { User } from '../../users/entities/user.entity';\nlet ProjectsService = class ProjectsService {\n  projectRepository;\n  stageRepository;\n  userRepository;\n  constructor(projectRepository, stageRepository, userRepository) {\n    this.projectRepository = projectRepository;\n    this.stageRepository = stageRepository;\n    this.userRepository = userRepository;\n  }\n  findAll() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      return _this.projectRepository.find({\n        relations: ['projectManager', 'stages', 'stages.tasks', 'stages.assignedTeamMembers']\n      });\n    })();\n  }\n  findByPlatform(platform) {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      return _this2.projectRepository.find({\n        where: {\n          platform\n        },\n        relations: ['projectManager', 'stages', 'stages.tasks', 'stages.assignedTeamMembers']\n      });\n    })();\n  }\n  findOne(id) {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      const project = yield _this3.projectRepository.findOne({\n        where: {\n          id\n        },\n        relations: ['projectManager', 'stages', 'stages.tasks', 'stages.assignedTeamMembers']\n      });\n      if (!project) {\n        throw new NotFoundException(`Project with ID ${id} not found`);\n      }\n      return project;\n    })();\n  }\n  create(projectData) {\n    var _this4 = this;\n    return _asyncToGenerator(function* () {\n      const project = _this4.projectRepository.create(projectData);\n      return _this4.projectRepository.save(project);\n    })();\n  }\n  update(id, projectData) {\n    var _this5 = this;\n    return _asyncToGenerator(function* () {\n      yield _this5.projectRepository.update(id, projectData);\n      return _this5.findOne(id);\n    })();\n  }\n  remove(id) {\n    var _this6 = this;\n    return _asyncToGenerator(function* () {\n      yield _this6.projectRepository.delete(id);\n    })();\n  }\n  assignProjectManager(projectId, managerId) {\n    var _this7 = this;\n    return _asyncToGenerator(function* () {\n      const project = yield _this7.findOne(projectId);\n      const manager = yield _this7.userRepository.findOne({\n        where: {\n          id: managerId\n        }\n      });\n      if (!manager) {\n        throw new NotFoundException(`User with ID ${managerId} not found`);\n      }\n      project.projectManager = manager;\n      project.projectManagerId = managerId;\n      return _this7.projectRepository.save(project);\n    })();\n  }\n  getAvailableManagers() {\n    var _this8 = this;\n    return _asyncToGenerator(function* () {\n      return _this8.userRepository.find({\n        where: {\n          role: 'project_manager'\n        }\n      });\n    })();\n  }\n  addTaskToStage(stageId, taskData) {\n    var _this9 = this;\n    return _asyncToGenerator(function* () {\n      const stage = yield _this9.stageRepository.findOne({\n        where: {\n          id: stageId\n        },\n        relations: ['tasks']\n      });\n      if (!stage) {\n        throw new NotFoundException(`Stage with ID ${stageId} not found`);\n      }\n      // Your task creation logic here\n      return {\n        stage,\n        taskData\n      };\n    })();\n  }\n};\nProjectsService = __decorate([Injectable(), __param(0, InjectRepository(Project)), __param(1, InjectRepository(ProjectStage)), __param(2, InjectRepository(User))], ProjectsService);\nexport { ProjectsService };","map":{"version":3,"names":["Injectable","NotFoundException","InjectRepository","Project","ProjectStage","User","ProjectsService","projectRepository","stageRepository","userRepository","constructor","findAll","_this","_asyncToGenerator","find","relations","findByPlatform","platform","_this2","where","findOne","id","_this3","project","create","projectData","_this4","save","update","_this5","remove","_this6","delete","assignProjectManager","projectId","managerId","_this7","manager","projectManager","projectManagerId","getAvailableManagers","_this8","role","addTaskToStage","stageId","taskData","_this9","stage","__decorate","__param"],"sources":["/home/deevan/cdl-project-management-system/frontend/src/app/shared/services/project.service.ts"],"sourcesContent":["import { Injectable, NotFoundException } from '@nestjs/common';\nimport { InjectRepository } from '@nestjs/typeorm';\nimport { Repository } from 'typeorm';\nimport { Project } from '../entities/project.entity';\nimport { ProjectStage } from '../entities/project-stage.entity';\nimport { User } from '../../users/entities/user.entity';\n\n@Injectable()\nexport class ProjectsService {\n  constructor(\n    @InjectRepository(Project)\n    private readonly projectRepository: Repository<Project>,\n    @InjectRepository(ProjectStage)\n    private readonly stageRepository: Repository<ProjectStage>,\n    @InjectRepository(User)\n    private readonly userRepository: Repository<User>,\n  ) {}\n\n  async findAll(): Promise<Project[]> {\n    return this.projectRepository.find({\n      relations: ['projectManager', 'stages', 'stages.tasks', 'stages.assignedTeamMembers'],\n    });\n  }\n\n  async findByPlatform(platform: string): Promise<Project[]> {\n    return this.projectRepository.find({\n      where: { platform },\n      relations: ['projectManager', 'stages', 'stages.tasks', 'stages.assignedTeamMembers'],\n    });\n  }\n\n  async findOne(id: string): Promise<Project> {\n    const project = await this.projectRepository.findOne({\n      where: { id },\n      relations: ['projectManager', 'stages', 'stages.tasks', 'stages.assignedTeamMembers'],\n    });\n\n    if (!project) {\n      throw new NotFoundException(`Project with ID ${id} not found`);\n    }\n\n    return project;\n  }\n\n  async create(projectData: Partial<Project>): Promise<Project> {\n    const project = this.projectRepository.create(projectData);\n    return this.projectRepository.save(project);\n  }\n\n  async update(id: string, projectData: Partial<Project>): Promise<Project> {\n    await this.projectRepository.update(id, projectData);\n    return this.findOne(id);\n  }\n\n  async remove(id: string): Promise<void> {\n    await this.projectRepository.delete(id);\n  }\n\n  async assignProjectManager(projectId: string, managerId: string): Promise<Project> {\n    const project = await this.findOne(projectId);\n    const manager = await this.userRepository.findOne({ where: { id: managerId } });\n\n    if (!manager) {\n      throw new NotFoundException(`User with ID ${managerId} not found`);\n    }\n\n    project.projectManager = manager;\n    project.projectManagerId = managerId;\n\n    return this.projectRepository.save(project);\n  }\n\n  async getAvailableManagers(): Promise<User[]> {\n    return this.userRepository.find({\n      where: { role: 'project_manager' },\n    });\n  }\n\n  async addTaskToStage(stageId: string, taskData: any): Promise<any> {\n    const stage = await this.stageRepository.findOne({\n      where: { id: stageId },\n      relations: ['tasks'],\n    });\n\n    if (!stage) {\n      throw new NotFoundException(`Stage with ID ${stageId} not found`);\n    }\n\n    // Your task creation logic here\n    return { stage, taskData };\n  }\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}