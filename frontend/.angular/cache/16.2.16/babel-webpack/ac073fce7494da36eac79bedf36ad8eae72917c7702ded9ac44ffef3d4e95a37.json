{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { Validators } from '@angular/forms';\nlet UserManagementComponent = class UserManagementComponent {\n  userService;\n  fb;\n  users = [];\n  filteredUsers = [];\n  showUserModal = false;\n  userForm;\n  isEditing = false;\n  editingUserId = null;\n  searchTerm = '';\n  selectedRole = 'all';\n  constructor(userService, fb) {\n    this.userService = userService;\n    this.fb = fb;\n    this.userForm = this.fb.group({\n      name: ['', [Validators.required, Validators.minLength(2)]],\n      email: ['', [Validators.required, Validators.email]],\n      role: ['', Validators.required],\n      avatar: ['']\n    });\n  }\n  ngOnInit() {\n    this.loadUsers();\n  }\n  loadUsers() {\n    this.userService.getAllUsers().subscribe({\n      next: users => {\n        this.users = users;\n        this.filterUsers();\n      },\n      error: error => console.error('Error loading users:', error)\n    });\n  }\n  filterUsers() {\n    this.filteredUsers = this.users.filter(user => {\n      const matchesSearch = user.name.toLowerCase().includes(this.searchTerm.toLowerCase()) || user.email.toLowerCase().includes(this.searchTerm.toLowerCase());\n      const matchesRole = this.selectedRole === 'all' || user.role === this.selectedRole;\n      return matchesSearch && matchesRole;\n    });\n  }\n  onSearchChange() {\n    this.filterUsers();\n  }\n  onRoleFilterChange() {\n    this.filterUsers();\n  }\n  openCreateUserModal() {\n    this.isEditing = false;\n    this.editingUserId = null;\n    this.userForm.reset();\n    this.showUserModal = true;\n  }\n  openEditUserModal(user) {\n    this.isEditing = true;\n    this.editingUserId = user.id;\n    this.userForm.patchValue({\n      name: user.name,\n      email: user.email,\n      role: user.role,\n      avatar: user.avatar\n    });\n    this.showUserModal = true;\n  }\n  closeUserModal() {\n    this.showUserModal = false;\n    this.userForm.reset();\n  }\n  onSubmitUser() {\n    if (this.userForm.valid) {\n      const userData = this.userForm.value;\n      if (this.isEditing && this.editingUserId) {\n        this.userService.updateUser(this.editingUserId, userData).subscribe({\n          next: updatedUser => {\n            const index = this.users.findIndex(u => u.id === updatedUser.id);\n            if (index !== -1) {\n              this.users[index] = updatedUser;\n            }\n            this.filterUsers();\n            this.closeUserModal();\n          },\n          error: error => console.error('Error updating user:', error)\n        });\n      } else {\n        this.userService.createUser(userData).subscribe({\n          next: newUser => {\n            this.users.unshift(newUser);\n            this.filterUsers();\n            this.closeUserModal();\n          },\n          error: error => console.error('Error creating user:', error)\n        });\n      }\n    }\n  }\n  toggleUserStatus(user) {\n    if (user.isActive) {\n      this.userService.deactivateUser(user.id).subscribe({\n        next: updatedUser => {\n          const index = this.users.findIndex(u => u.id === updatedUser.id);\n          if (index !== -1) {\n            this.users[index] = updatedUser;\n          }\n          this.filterUsers();\n        },\n        error: error => console.error('Error deactivating user:', error)\n      });\n    } else {\n      this.userService.activateUser(user.id).subscribe({\n        next: updatedUser => {\n          const index = this.users.findIndex(u => u.id === updatedUser.id);\n          if (index !== -1) {\n            this.users[index] = updatedUser;\n          }\n          this.filterUsers();\n        },\n        error: error => console.error('Error activating user:', error)\n      });\n    }\n  }\n  deleteUser(user) {\n    if (confirm(`Are you sure you want to delete user ${user.name}? This action cannot be undone.`)) {\n      this.userService.deleteUser(user.id).subscribe({\n        next: () => {\n          this.users = this.users.filter(u => u.id !== user.id);\n          this.filterUsers();\n        },\n        error: error => console.error('Error deleting user:', error)\n      });\n    }\n  }\n  getRoleDisplayName(role) {\n    return this.userService.getRoleDisplayName(role);\n  }\n  getAllRoles() {\n    return this.userService.getAllRoles();\n  }\n  formatDate(date) {\n    return new Date(date).toLocaleDateString('en-US', {\n      year: 'numeric',\n      month: 'short',\n      day: 'numeric'\n    });\n  }\n};\nUserManagementComponent = __decorate([Component({\n  selector: 'app-user-management',\n  templateUrl: './user-management.component.html',\n  styleUrls: ['./user-management.component.css']\n})], UserManagementComponent);\nexport { UserManagementComponent };","map":{"version":3,"names":["Component","Validators","UserManagementComponent","userService","fb","users","filteredUsers","showUserModal","userForm","isEditing","editingUserId","searchTerm","selectedRole","constructor","group","name","required","minLength","email","role","avatar","ngOnInit","loadUsers","getAllUsers","subscribe","next","filterUsers","error","console","filter","user","matchesSearch","toLowerCase","includes","matchesRole","onSearchChange","onRoleFilterChange","openCreateUserModal","reset","openEditUserModal","id","patchValue","closeUserModal","onSubmitUser","valid","userData","value","updateUser","updatedUser","index","findIndex","u","createUser","newUser","unshift","toggleUserStatus","isActive","deactivateUser","activateUser","deleteUser","confirm","getRoleDisplayName","getAllRoles","formatDate","date","Date","toLocaleDateString","year","month","day","__decorate","selector","templateUrl","styleUrls"],"sources":["/home/deevan/cdl-project-management-system/frontend/src/app/admin/admin-dashboard/user-management/user-management.component.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { UserManagementService } from '../../shared/services/user-management.service';\nimport { User, UserRole, CreateUserDto } from '../../shared/models/user.model';\n\n@Component({\n  selector: 'app-user-management',\n  templateUrl: './user-management.component.html',\n  styleUrls: ['./user-management.component.css']\n})\nexport class UserManagementComponent implements OnInit {\n  users: User[] = [];\n  filteredUsers: User[] = [];\n  showUserModal = false;\n  userForm: FormGroup;\n  isEditing = false;\n  editingUserId: string | null = null;\n  searchTerm = '';\n  selectedRole: UserRole | 'all' = 'all';\n\n  constructor(\n    private userService: UserManagementService,\n    private fb: FormBuilder\n  ) {\n    this.userForm = this.fb.group({\n      name: ['', [Validators.required, Validators.minLength(2)]],\n      email: ['', [Validators.required, Validators.email]],\n      role: ['', Validators.required],\n      avatar: ['']\n    });\n  }\n\n  ngOnInit() {\n    this.loadUsers();\n  }\n\n  loadUsers() {\n    this.userService.getAllUsers().subscribe({\n      next: (users) => {\n        this.users = users;\n        this.filterUsers();\n      },\n      error: (error) => console.error('Error loading users:', error)\n    });\n  }\n\n  filterUsers() {\n    this.filteredUsers = this.users.filter(user => {\n      const matchesSearch = user.name.toLowerCase().includes(this.searchTerm.toLowerCase()) ||\n                           user.email.toLowerCase().includes(this.searchTerm.toLowerCase());\n      const matchesRole = this.selectedRole === 'all' || user.role === this.selectedRole;\n      return matchesSearch && matchesRole;\n    });\n  }\n\n  onSearchChange() {\n    this.filterUsers();\n  }\n\n  onRoleFilterChange() {\n    this.filterUsers();\n  }\n\n  openCreateUserModal() {\n    this.isEditing = false;\n    this.editingUserId = null;\n    this.userForm.reset();\n    this.showUserModal = true;\n  }\n\n  openEditUserModal(user: User) {\n    this.isEditing = true;\n    this.editingUserId = user.id;\n    this.userForm.patchValue({\n      name: user.name,\n      email: user.email,\n      role: user.role,\n      avatar: user.avatar\n    });\n    this.showUserModal = true;\n  }\n\n  closeUserModal() {\n    this.showUserModal = false;\n    this.userForm.reset();\n  }\n\n  onSubmitUser() {\n    if (this.userForm.valid) {\n      const userData: CreateUserDto = this.userForm.value;\n\n      if (this.isEditing && this.editingUserId) {\n        this.userService.updateUser(this.editingUserId, userData).subscribe({\n          next: (updatedUser) => {\n            const index = this.users.findIndex(u => u.id === updatedUser.id);\n            if (index !== -1) {\n              this.users[index] = updatedUser;\n            }\n            this.filterUsers();\n            this.closeUserModal();\n          },\n          error: (error) => console.error('Error updating user:', error)\n        });\n      } else {\n        this.userService.createUser(userData).subscribe({\n          next: (newUser) => {\n            this.users.unshift(newUser);\n            this.filterUsers();\n            this.closeUserModal();\n          },\n          error: (error) => console.error('Error creating user:', error)\n        });\n      }\n    }\n  }\n\n  toggleUserStatus(user: User) {\n    if (user.isActive) {\n      this.userService.deactivateUser(user.id).subscribe({\n        next: (updatedUser) => {\n          const index = this.users.findIndex(u => u.id === updatedUser.id);\n          if (index !== -1) {\n            this.users[index] = updatedUser;\n          }\n          this.filterUsers();\n        },\n        error: (error) => console.error('Error deactivating user:', error)\n      });\n    } else {\n      this.userService.activateUser(user.id).subscribe({\n        next: (updatedUser) => {\n          const index = this.users.findIndex(u => u.id === updatedUser.id);\n          if (index !== -1) {\n            this.users[index] = updatedUser;\n          }\n          this.filterUsers();\n        },\n        error: (error) => console.error('Error activating user:', error)\n      });\n    }\n  }\n\n  deleteUser(user: User) {\n    if (confirm(`Are you sure you want to delete user ${user.name}? This action cannot be undone.`)) {\n      this.userService.deleteUser(user.id).subscribe({\n        next: () => {\n          this.users = this.users.filter(u => u.id !== user.id);\n          this.filterUsers();\n        },\n        error: (error) => console.error('Error deleting user:', error)\n      });\n    }\n  }\n\n  getRoleDisplayName(role: UserRole): string {\n    return this.userService.getRoleDisplayName(role);\n  }\n\n  getAllRoles(): UserRole[] {\n    return this.userService.getAllRoles();\n  }\n\n  formatDate(date: Date): string {\n    return new Date(date).toLocaleDateString('en-US', {\n      year: 'numeric',\n      month: 'short',\n      day: 'numeric'\n    });\n  }\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}