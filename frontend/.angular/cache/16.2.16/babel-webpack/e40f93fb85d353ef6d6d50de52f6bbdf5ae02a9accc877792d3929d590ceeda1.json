{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nlet UserDashboardComponent = class UserDashboardComponent {\n  projectService;\n  taskService;\n  projects = [];\n  userTasks = [];\n  currentUser = {\n    id: 'u3',\n    name: 'Siddhant Salve',\n    email: 'siddhant@cdl.com',\n    role: 'lead_developer',\n    avatar: 'https://i.pravatar.cc/150?u=siddhant',\n    isActive: true\n  };\n  currentView = 'home';\n  selectedProject = null;\n  isDarkMode = false;\n  constructor(projectService, taskService) {\n    this.projectService = projectService;\n    this.taskService = taskService;\n  }\n  ngOnInit() {\n    this.loadUserProjects();\n    this.loadUserTasks();\n    this.detectColorScheme();\n  }\n  loadUserProjects() {\n    this.projectService.getAllProjects().subscribe({\n      next: projects => {\n        // Filter projects where user is assigned to any stage or task\n        this.projects = projects.filter(project => project.stages.some(stage => stage.assignedTeamMembers.some(user => user.id === this.currentUser.id) || stage.tasks.some(task => task.assignedTeamMembers.some(user => user.id === this.currentUser.id))));\n      },\n      error: error => console.error('Error loading user projects:', error)\n    });\n  }\n  loadUserTasks() {\n    this.taskService.getTasksByUser(this.currentUser.id).subscribe({\n      next: tasks => {\n        this.userTasks = tasks;\n      },\n      error: error => console.error('Error loading user tasks:', error)\n    });\n  }\n  navigateTo(view) {\n    this.currentView = view;\n    this.selectedProject = null;\n  }\n  selectProject(project) {\n    this.selectedProject = project;\n  }\n  toggleTaskCompletion(task) {\n    const newStatus = !task.isCompleted;\n    this.taskService.updateTaskStatus(task.id, newStatus ? 'completed' : 'on_track', newStatus).subscribe({\n      next: updatedTask => {\n        // Update local task\n        const taskIndex = this.userTasks.findIndex(t => t.id === task.id);\n        if (taskIndex !== -1) {\n          this.userTasks[taskIndex] = updatedTask;\n        }\n        // Update project tasks if a project is selected\n        if (this.selectedProject) {\n          this.updateProjectTask(updatedTask);\n        }\n        // Reload projects to update progress\n        this.loadUserProjects();\n      },\n      error: error => console.error('Error updating task status:', error)\n    });\n  }\n  updateProjectTask(updatedTask) {\n    for (const stage of this.selectedProject.stages) {\n      const taskIndex = stage.tasks.findIndex(t => t.id === updatedTask.id);\n      if (taskIndex !== -1) {\n        stage.tasks[taskIndex] = updatedTask;\n        break;\n      }\n    }\n  }\n  getStats() {\n    const totalTasks = this.userTasks.length;\n    const completedTasks = this.userTasks.filter(t => t.isCompleted).length;\n    const overdueTasks = this.userTasks.filter(t => !t.isCompleted && new Date(t.endDate) < new Date()).length;\n    const atRiskTasks = this.userTasks.filter(t => !t.isCompleted && !this.isOverdue(t) && this.daysUntilDue(t) <= 7).length;\n    return {\n      totalTasks,\n      completedTasks,\n      overdueTasks,\n      atRiskTasks\n    };\n  }\n  isOverdue(task) {\n    return new Date(task.endDate) < new Date() && !task.isCompleted;\n  }\n  daysUntilDue(task) {\n    const dueDate = new Date(task.endDate);\n    const today = new Date();\n    const timeDiff = dueDate.getTime() - today.getTime();\n    return Math.ceil(timeDiff / (1000 * 3600 * 24));\n  }\n  toggleDarkMode() {\n    this.isDarkMode = !this.isDarkMode;\n    if (this.isDarkMode) {\n      document.documentElement.classList.add('dark');\n    } else {\n      document.documentElement.classList.remove('dark');\n    }\n  }\n  detectColorScheme() {\n    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {\n      this.isDarkMode = true;\n      document.documentElement.classList.add('dark');\n    }\n  }\n  // Helper methods for template\n  getNavClass(view) {\n    const baseClasses = \"w-full text-left px-4 py-2 rounded-md transition-colors duration-200\";\n    const activeClasses = this.currentView === view ? 'bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300' : 'text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700';\n    return `${baseClasses} ${activeClasses}`;\n  }\n  getStatusBadgeClass(status) {\n    const colors = {\n      'on_track': 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300',\n      'at_risk': 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300',\n      'overdue': 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300',\n      'completed': 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300'\n    };\n    return `px-2.5 py-0.5 text-xs font-medium rounded-full ${colors[status] || 'bg-gray-100 text-gray-800'}`;\n  }\n  getProgressBarClass(status) {\n    const colors = {\n      'on_track': 'bg-green-500',\n      'at_risk': 'bg-yellow-500',\n      'overdue': 'bg-red-500',\n      'completed': 'bg-green-500'\n    };\n    return `h-2 rounded-full transition-all duration-500 ${colors[status] || 'bg-gray-500'}`;\n  }\n};\nUserDashboardComponent = __decorate([Component({\n  selector: 'app-user-dashboard',\n  templateUrl: './user-dashboard.component.html',\n  styleUrls: ['./user-dashboard.component.css']\n})], UserDashboardComponent);\nexport { UserDashboardComponent };","map":{"version":3,"names":["Component","UserDashboardComponent","projectService","taskService","projects","userTasks","currentUser","id","name","email","role","avatar","isActive","currentView","selectedProject","isDarkMode","constructor","ngOnInit","loadUserProjects","loadUserTasks","detectColorScheme","getAllProjects","subscribe","next","filter","project","stages","some","stage","assignedTeamMembers","user","tasks","task","error","console","getTasksByUser","navigateTo","view","selectProject","toggleTaskCompletion","newStatus","isCompleted","updateTaskStatus","updatedTask","taskIndex","findIndex","t","updateProjectTask","getStats","totalTasks","length","completedTasks","overdueTasks","Date","endDate","atRiskTasks","isOverdue","daysUntilDue","dueDate","today","timeDiff","getTime","Math","ceil","toggleDarkMode","document","documentElement","classList","add","remove","window","matchMedia","matches","getNavClass","baseClasses","activeClasses","getStatusBadgeClass","status","colors","getProgressBarClass","__decorate","selector","templateUrl","styleUrls"],"sources":["/home/deevan/cdl-project-management-system/frontend/src/app/user/user-dashboard/user-dashboard.component.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { ProjectService } from '../../shared/services/project.service';\nimport { TaskService } from '../../shared/services/task.service';\nimport { Project, ProjectPlatform, ProjectStatus, User, Task } from '../../shared/models/project.model';\n\n@Component({\n  selector: 'app-user-dashboard',\n  templateUrl: './user-dashboard.component.html',\n  styleUrls: ['./user-dashboard.component.css']\n})\nexport class UserDashboardComponent implements OnInit {\n  projects: Project[] = [];\n  userTasks: Task[] = [];\n  currentUser: User = {\n    id: 'u3',\n    name: 'Siddhant Salve',\n    email: 'siddhant@cdl.com',\n    role: 'lead_developer',\n    avatar: 'https://i.pravatar.cc/150?u=siddhant',\n    isActive: true\n  };\n  \n  currentView: 'home' | 'flame' | 'swayam' = 'home';\n  selectedProject: Project | null = null;\n  isDarkMode = false;\n\n  constructor(\n    private projectService: ProjectService,\n    private taskService: TaskService\n  ) {}\n\n  ngOnInit() {\n    this.loadUserProjects();\n    this.loadUserTasks();\n    this.detectColorScheme();\n  }\n\n  loadUserProjects() {\n    this.projectService.getAllProjects().subscribe({\n      next: (projects) => {\n        // Filter projects where user is assigned to any stage or task\n        this.projects = projects.filter(project => \n          project.stages.some(stage => \n            stage.assignedTeamMembers.some(user => user.id === this.currentUser.id) ||\n            stage.tasks.some(task => \n              task.assignedTeamMembers.some(user => user.id === this.currentUser.id)\n            )\n          )\n        );\n      },\n      error: (error) => console.error('Error loading user projects:', error)\n    });\n  }\n\n  loadUserTasks() {\n    this.taskService.getTasksByUser(this.currentUser.id).subscribe({\n      next: (tasks) => {\n        this.userTasks = tasks;\n      },\n      error: (error) => console.error('Error loading user tasks:', error)\n    });\n  }\n\n  navigateTo(view: 'home' | 'flame' | 'swayam') {\n    this.currentView = view;\n    this.selectedProject = null;\n  }\n\n  selectProject(project: Project) {\n    this.selectedProject = project;\n  }\n\n  toggleTaskCompletion(task: Task) {\n    const newStatus = !task.isCompleted;\n    this.taskService.updateTaskStatus(task.id, \n      newStatus ? 'completed' : 'on_track', \n      newStatus\n    ).subscribe({\n      next: (updatedTask) => {\n        // Update local task\n        const taskIndex = this.userTasks.findIndex(t => t.id === task.id);\n        if (taskIndex !== -1) {\n          this.userTasks[taskIndex] = updatedTask;\n        }\n        \n        // Update project tasks if a project is selected\n        if (this.selectedProject) {\n          this.updateProjectTask(updatedTask);\n        }\n        \n        // Reload projects to update progress\n        this.loadUserProjects();\n      },\n      error: (error) => console.error('Error updating task status:', error)\n    });\n  }\n\n  private updateProjectTask(updatedTask: Task) {\n    for (const stage of this.selectedProject!.stages) {\n      const taskIndex = stage.tasks.findIndex(t => t.id === updatedTask.id);\n      if (taskIndex !== -1) {\n        stage.tasks[taskIndex] = updatedTask;\n        break;\n      }\n    }\n  }\n\n  getStats() {\n    const totalTasks = this.userTasks.length;\n    const completedTasks = this.userTasks.filter(t => t.isCompleted).length;\n    const overdueTasks = this.userTasks.filter(t => \n      !t.isCompleted && new Date(t.endDate) < new Date()\n    ).length;\n    const atRiskTasks = this.userTasks.filter(t => \n      !t.isCompleted && \n      !this.isOverdue(t) && \n      this.daysUntilDue(t) <= 7\n    ).length;\n\n    return { totalTasks, completedTasks, overdueTasks, atRiskTasks };\n  }\n\n  private isOverdue(task: Task): boolean {\n    return new Date(task.endDate) < new Date() && !task.isCompleted;\n  }\n\n  private daysUntilDue(task: Task): number {\n    const dueDate = new Date(task.endDate);\n    const today = new Date();\n    const timeDiff = dueDate.getTime() - today.getTime();\n    return Math.ceil(timeDiff / (1000 * 3600 * 24));\n  }\n\n  toggleDarkMode() {\n    this.isDarkMode = !this.isDarkMode;\n    if (this.isDarkMode) {\n      document.documentElement.classList.add('dark');\n    } else {\n      document.documentElement.classList.remove('dark');\n    }\n  }\n\n  private detectColorScheme() {\n    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {\n      this.isDarkMode = true;\n      document.documentElement.classList.add('dark');\n    }\n  }\n\n  // Helper methods for template\n  getNavClass(view: string): string {\n    const baseClasses = \"w-full text-left px-4 py-2 rounded-md transition-colors duration-200\";\n    const activeClasses = this.currentView === view \n      ? 'bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300' \n      : 'text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700';\n    return `${baseClasses} ${activeClasses}`;\n  }\n\n  getStatusBadgeClass(status: string): string {\n    const colors: { [key: string]: string } = {\n      'on_track': 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300',\n      'at_risk': 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300',\n      'overdue': 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300',\n      'completed': 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300'\n    };\n    return `px-2.5 py-0.5 text-xs font-medium rounded-full ${colors[status] || 'bg-gray-100 text-gray-800'}`;\n  }\n\n  getProgressBarClass(status: string): string {\n    const colors: { [key: string]: string } = {\n      'on_track': 'bg-green-500',\n      'at_risk': 'bg-yellow-500',\n      'overdue': 'bg-red-500',\n      'completed': 'bg-green-500'\n    };\n    return `h-2 rounded-full transition-all duration-500 ${colors[status] || 'bg-gray-500'}`;\n  }\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}